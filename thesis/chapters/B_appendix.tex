\chapter{Numerical rank}
\label{chp:B-appendix}

The \glsfirst{numerical-rank} of the symmetric \gls{PSD} matrix
$g_{\sigma}(t\mtx{I}_n - \mtx{A})$ is used to motivate the introduction of a
low-rank factorization in \refchp{chp:3-nystrom} and also appears in the formulation
and proof of \refthm{thm:3-nystrom-nystrom-method}.
\refequ{equ:3-nystrom-kernel-numerical-rank} provides a tractable expression
of \gls{numerical-rank} for Gaussian $g_{\sigma}(t\mtx{I}_n - \mtx{A})$.
We now show how this formula was determined.\\

For the spectral norm $\lVert \cdot \rVert _2$, we calculate
\begin{align*}
    &r_{\varepsilon, 2}(g_{\sigma}(t\mtx{I}_n - \mtx{A})) \notag \\ 
    &= \min\{1 \leq r \leq n: \sigma_{r+1}(t) \leq \varepsilon \}
    && \text{(definition \refequ{equ:3-nystrom-numerical-rank-spectral-norm})} \notag \\
    &= \min\left\{1 \leq r \leq n: \frac{1}{n \sqrt{2 \pi \sigma^2}}e^{-\frac{(t - \lambda_{(r+1)})^2}{2\sigma^2}} \leq \varepsilon \right\}
    && \text{(expression \refequ{equ:3-nystrom-kernel-function-eigenvalues})} \notag \\
    &= \min\left\{1 \leq r \leq n: |t - \lambda_{(r+1)}| \geq \sigma \sqrt{-2 \log(\varepsilon  n \sqrt{2 \pi \sigma^2})} \right\}
    && \text{(rearrangement)} \notag \\
    &= \#\left\{1\leq i \leq n: |t - \lambda_i| < \sigma \sqrt{-2 \log(\varepsilon  n \sqrt{2 \pi \sigma^2})} \right\}
    && \text{($|t - \lambda_{(1)}| \leq \cdots \leq |t - \lambda_{(n)}|$)}
    \label{chp:B-appendix-kernel-numerical-rank}
\end{align*}
Here, we identify $C_{\varepsilon, 2} = \sigma \sqrt{-2 \log(\varepsilon  n \sqrt{2 \pi \sigma^2})}$
to end up with the expression \refequ{equ:3-nystrom-kernel-numerical-rank-spectral-constant}.\\

For the nuclear and Frobenius norm we use the fact that
\begin{equation}
    \frac{1}{n} \sqrt{\sum_{i=r+1}^n \sigma_{i}(t)^2} \leq \frac{1}{\sqrt{n}} \sum_{i=r+1}^n \sigma_{i}(t) \leq \sigma_{r+1}(t)
\end{equation}
to apply the same reasoning as for the spectral norm above, though for slightly
different constants $C_{\varepsilon, \ast}$ and $C_{\varepsilon, F}$.
